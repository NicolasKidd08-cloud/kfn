-- CONNECTION TEST SCRIPT
-- Run this first to test if the connection works

local HttpService = game:GetService("HttpService")

-- CHANGE THIS URL
local TEST_URL = "http://192.168.68.63:8080/jobs"

print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
print("ğŸ”§ NEXA CONNECTION TEST")
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
print("Testing URL: " .. TEST_URL)
print("")

-- Test 1: Check if HttpService works
print("Test 1: HttpService Enabled")
local httpEnabled = pcall(function()
    HttpService:GetAsync("https://google.com")
end)

if httpEnabled then
    print("âœ… HttpService is working!")
else
    print("âŒ HttpService is NOT enabled!")
    print("ğŸ’¡ Solution: Enable HTTP in game settings")
    print("   Home > Game Settings > Security > Allow HTTP Requests")
    print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
    return
end

print("")

-- Test 2: Try to connect to your server
print("Test 2: Connecting to Desktop App")
local success, result = pcall(function()
    return HttpService:GetAsync(TEST_URL, true)
end)

if success then
    print("âœ… CONNECTION SUCCESS!")
    print("")
    print("Response received:")
    print(result:sub(1, 200)) -- Show first 200 chars
    print("")
    
    -- Try to parse JSON
    local parseSuccess, jobs = pcall(function()
        return HttpService:JSONDecode(result)
    end)
    
    if parseSuccess then
        print("âœ… JSON parsed successfully!")
        print("Jobs found: " .. #jobs)
        if #jobs > 0 then
            print("")
            print("First job:")
            print("  Name: " .. (jobs[1].name or "N/A"))
            print("  Money: " .. (jobs[1].money or "N/A"))
        end
    else
        print("âš ï¸ Could not parse JSON")
    end
else
    print("âŒ CONNECTION FAILED!")
    print("")
    print("Error: " .. tostring(result))
    print("")
    print("ğŸ’¡ Possible Solutions:")
    print("1. Make sure Python Desktop App is running")
    print("2. Check if the URL is correct: " .. TEST_URL)
    print("3. Try clicking 'Test Server' in Python app")
    print("4. Check Windows Firewall - it might be blocking")
    print("5. Try turning off antivirus temporarily")
end

print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
